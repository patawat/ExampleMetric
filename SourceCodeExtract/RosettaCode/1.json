{"isSuccess":true,"url":"http://rosettacode.org//wiki/Text_processing/1","codeArray":["var filename = 'readings.txt';\n  var show_lines = 5;\n  var file_stats = {\n      'num_readings': 0,\n      'total': 0,\n      'reject_run': 0,\n      'reject_run_max': 0,\n      'reject_run_date': ''\n  };\n  var fh = new ActiveXObject(\"Scripting.FileSystemObject\").openTextFile(filename, 1); // 1 = for reading\n  while ( ! fh.atEndOfStream) {\n      var line = fh.ReadLine();\n      line_stats(line, (show_lines-- > 0));\n  }\n  fh.close();\n  WScript.echo(\n      \"\\nFile(s)  = \" + filename + \"\\n\" +\n      \"Total    = \" + dec3(file_stats.total) + \"\\n\" +\n      \"Readings = \" + file_stats.num_readings + \"\\n\" +\n      \"Average  = \" + dec3(file_stats.total / file_stats.num_readings) + \"\\n\\n\" +\n      \"Maximum run of \" + file_stats.reject_run_max + \n      \" consecutive false readings ends at \" + file_stats.reject_run_date\n  );\n  function line_stats(line, print_line) {\n      var readings = 0;\n      var rejects = 0;\n      var total = 0;\n      var fields = line.split('\\t');\n      var date = fields.shift();\n      while (fields.length > 0) {\n          var value = parseFloat(fields.shift());\n          var flag = parseInt(fields.shift(), 10);\n          readings++;\n          if (flag <= 0) {\n              rejects++;\n              file_stats.reject_run++;\n          }\n          else {\n              total += value;\n              if (file_stats.reject_run > file_stats.reject_run_max) {\n                  file_stats.reject_run_max = file_stats.reject_run;\n                  file_stats.reject_run_date = date;\n              }\n              file_stats.reject_run = 0;\n          }\n      }\n      file_stats.num_readings += readings - rejects;\n      file_stats.total += total;\n      if (print_line) {\n          WScript.echo(\n              \"Line: \" + date + \"\\t\" +\n              \"Reject: \" + rejects + \"\\t\" +\n              \"Accept: \" + (readings - rejects) + \"\\t\" +\n              \"Line_tot: \" + dec3(total) + \"\\t\" +\n              \"Line_avg: \" + ((readings == rejects) ? \"0.0\" : dec3(total / (readings - rejects)))\n          );\n      }\n  }\n  // round a number to 3 decimal places\n  function dec3(value) {\n      return Math.round(value * 1e3) / 1e3;\n  }"],"uncertainCodeArray":[],"textArray":[]}