{"isSuccess":true,"url":"http://rosettacode.org//wiki/Text_processing/2","codeArray":["// wrap up the counter variables in a closure.\n  function analyze_func(filename) {\n      var dates_seen = {};\n      var format_bad = 0;\n      var records_all = 0;\n      var records_good = 0;\n      return function() {\n          var fh = new ActiveXObject(\"Scripting.FileSystemObject\").openTextFile(filename, 1); // 1 = for reading\n          while ( ! fh.atEndOfStream) {\n              records_all ++;\n              var allOK = true;\n              var line = fh.ReadLine();\n              var fields = line.split('\\t');\n              if (fields.length != 49) {\n                  format_bad ++;\n                  continue;\n              }\n              var date = fields.shift();\n              if (has_property(dates_seen, date)) \n                  WScript.echo(\"duplicate date: \" + date);\n              else\n                  dates_seen[date] = 1;\n              while (fields.length > 0) {\n                  var value = parseFloat(fields.shift());\n                  var flag = parseInt(fields.shift(), 10);\n                  if (isNaN(value) || isNaN(flag)) {\n                      format_bad ++;\n                  }\n                  else if (flag <= 0) {\n                      allOK = false;\n                  }\n              }\n              if (allOK)\n                  records_good ++;\n          }\n          fh.close();\n          WScript.echo(\"total records: \" + records_all);\n          WScript.echo(\"Wrong format: \" + format_bad);\n          WScript.echo(\"records with no bad readings: \" + records_good);\n      }\n  }\n  function has_property(obj, propname) {\n      return typeof(obj[propname]) == \"undefined\" ? false : true;\n  }\n  var analyze = analyze_func('readings.txt');\n  analyze();"],"uncertainCodeArray":[],"textArray":[]}